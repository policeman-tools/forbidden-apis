= Ant usage instructions =

The Ant task can be downloaded as an Ant Task from this web page (the JAR file provides both the Maven Mojo and the Ant Task). Place the JAR file in the lib folder of your Ant project and include the taskdef like the following:

{{{
<project>

  <taskdef name="forbiddenapis" classname="de.thetaphi.forbiddenapis.AntTask" classpath="path/to/forbiddenapis.jar"/>

  <property name="build.dir" location="..."/>
  <property name="jdk.version" value="1.6"/>

  <path id="build.classpath">
    <!--
     define your build classpath here, so all referenced JAR files can be found.
     This classpath should be used by javac and the forbidden API checker.
    -->
  </path>

  <!--- your other tasks -->

  <target name="compile">
    <javac classpathref="build.classpath" srcdir="${build.dir}"
      source="${jdk.version}" target="${jdk.version}"/>
  </target>

  <target name="forbidden-checks" depends="compile">
    <forbiddenapis internalRuntimeForbidden="true" classpathref="build.classpath" dir="${build.dir}">
      <bundledsignatures name="jdk-unsafe-${jdk.version}"/>
      <bundledsignatures name="jdk-deprecated-${jdk.version}"/>
    </forbiddenapis>
  </target>

</project>
}}}

Alternatively, if you have the forbiddenapis.jar in your ~/.ant/lib folder, you can omit the taskdef and use it via an ANTLIB mechanism:

{{{
<project xmlns:fa="antlib:de.thetaphi.forbiddenapis">

  <!-- ... -->
  <fa:forbiddenapis .../>

</project>
}}}

If your project is using [http://ant.apache.org/ivy/ Apache Ivy] (recommended), you can define a cachepath for Ivy and download it automatically from Maven Central:

{{{
<project xmlns:ivy="antlib:org.apache.ivy.ant" xmlns:fa="antlib:de.thetaphi.forbiddenapis">

  <property name="build.dir" location="..."/>
  <property name="jdk.version" value="1.6"/>

  <path id="build.classpath">
    <!--
     define your build classpath here, so all referenced JAR files can be found.
     This classpath should be used by javac and the forbidden API checker.
    -->
  </path>

  <target name="-init">
    <ivy:cachepath organisation="de.thetaphi" module="forbiddenapis" revision="1.0"
      inline="true" pathid="forbiddenapis.classpath"/>
    <taskdef uri="antlib:de.thetaphi.forbiddenapis" classpathref="forbiddenapis.classpath"/>
  </target>

  <!--- your other tasks -->

  <target name="compile" depends="-init">
    <javac classpathref="build.classpath" srcdir="${build.dir}"
      source="${jdk.version}" target="${jdk.version}"/>
  </target>

  <target name="forbidden-checks" depends="compile">
    <fa:forbiddenapis internalRuntimeForbidden="true" classpathref="build.classpath" dir="${build.dir}">
      <bundledsignatures name="jdk-unsafe-${jdk.version}"/>
      <bundledsignatures name="jdk-deprecated-${jdk.version}"/>
    </fa:forbiddenapis>
  </target>

</project>
}}}

If you don't like the additional XML-Namespaces, you can of course also define the task like in the first example, with Ivy's cachepath as reference.